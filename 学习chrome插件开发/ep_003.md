# 第三部分：浏览器按钮与默认弹窗（Manifest V3）

在Chrome扩展的Manifest V3中，有一个重要的API变化：原来在`manifest.json`中使用的`browser_action`或`page_action`属性，现在需要替换为`action`。


## V3的配置文件（manifest.json）
下面是Manifest V3的配置示例，其中`default_title`（鼠标悬停时显示的标题）和`default_popup`（点击按钮时显示的弹窗）都放在了新的`action`字段中：
```json
{
  "version": "0.0.103",
  "name": "Test",
  "description": "Manifest V3 Test",
  "host_permissions": ["*://*/*"],  // 权限声明，替代了V2中的"permissions"
  "action": {
    "default_title": "MV3Test",    // 鼠标悬停在按钮上时显示的文字
    "default_popup": "html/popup.html"  // 点击按钮时打开的弹窗文件路径
  },
  "content_scripts": [  // 内容脚本配置，和V2类似
    {
      "js": ["js/content.js"],
      "matches": ["*://*/*"]
    }
  ],
  "manifest_version": 3  // 声明使用Manifest V3
}
```


## V3的弹窗文件（popup.html）
这是Manifest V3对应的弹窗页面，保存路径为`ep_003/v3/html/popup.html`：
```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Pop-Up from Manifest V3</title>  // 弹窗标题
  </head>
  <body>
    <h1>Manifest V3 Test</h1>  // 弹窗中显示的内容
  </body>
</html>
```


## 安装方法
把`ep_003/v3`文件夹拖到Chrome的扩展页面（`chrome://extensions`）中，即可加载这个V3版本的扩展（在Chrome Canary 80.0.3968.0版本中可尝试）。


## 实际效果
- 在加载了网页的标签页中（安装后记得刷新页面），扩展按钮会处于激活状态。
- 但目前可能无法显示默认标题，也无法正常加载弹窗。


## 问题说明
在扩展的错误信息中，会看到这样的提示：
```
'action' requires trunk channel or newer, but is is the canary channel.
```
意思是`action`字段需要更高版本的Chrome（如trunk通道），当前的Canary版本还不支持，这就是导致弹窗和标题无法正常工作的原因。