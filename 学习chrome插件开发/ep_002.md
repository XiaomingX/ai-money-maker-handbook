# 第二部分：扩展的运行权限（仅Manifest V3）

在扩展迁移指南的API清单中，针对V3有一个关键要求：如果你的`manifest.json`里，曾在`permissions`或`optional_permissions`数组中配置过“主机权限”，现在需要把这些权限移到专门的`host_permissions`字段里。


## 1. Manifest V3的配置文件
以下是完整的V3版本配置文件（`manifest.json`），核心变化是“主机权限”单独放在了`host_permissions`字段中：
```
{
  "version": "0.0.102",       // 扩展版本号
  "name": "Test",             // 扩展名称（V3版本命名）
  "description": "Manifest V3 Test",  // 扩展描述（标注V3版本）
  "host_permissions": ["*://*/*"],    // 关键：主机权限移到这里，"*://*/*"表示允许访问所有网站
  "content_scripts": [        // 内容脚本配置（和V2逻辑一致）
    {
      "js": ["js/content.js"],        // 要加载的脚本文件路径
      "matches": ["*://*/*"]          // 脚本生效的网站范围（所有网站）
    }
  ],
  "manifest_version": 3       // 核心标识：声明这是Manifest V3扩展
}
```


## 2. Manifest V3的内容脚本
V3版本的内容脚本非常简单，仅用于验证是否加载成功，文件路径为`ep_002/v3/js/content.js`，内容如下：
```
// 脚本加载成功后，会在浏览器控制台打印这句话
console.log("Content script has loaded via Manifest V3.");
```


## 3. 加载与验证步骤
1. 打开Chrome浏览器（推荐Chrome Canary版本，对V3支持更友好），在地址栏输入`chrome://extensions`，进入扩展管理页面。
2. 把存放V3配置的文件夹（`ep_002/v3`）直接拖到`chrome://extensions`页面，完成扩展加载。
3. 注意：加载后可能会看到“`manifest_version: 3`不被支持”的提示，这是暂时的正常现象，不影响基础功能测试。
4. 验证是否生效：打开任意一个新网页，右键点击页面空白处选择“检查”，在弹出的开发者工具中切换到“Console”（控制台）标签，若能看到`Content script has loaded via Manifest V3.`这句话，说明V3扩展运行正常。


## 最终状态
Manifest V3扩展的基础加载和权限配置均正常，核心功能可正常使用。
